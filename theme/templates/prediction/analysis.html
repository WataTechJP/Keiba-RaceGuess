<!-- prettier-ignore -->

{% extends "base.html" %}
{% load static %}

{% block title %}ãƒ‡ãƒ¼ã‚¿åˆ†æ{% endblock %}

{% block content %}
<h1 class="text-2xl font-bold text-blue-600 mb-2">ãƒ‡ãƒ¼ã‚¿åˆ†æ</h1>
<h2 class="text-xl font-bold text-black mb-2">
  ç«¶é¦¬äºˆæƒ³ã®å…¨ä½“çš„ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’åˆ†æã—ã€çµ±è¨ˆæƒ…å ±ã‚’ç¢ºèªã§ãã¾ã™ã€‚
</h2>

{% if success %}
<!-- æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
<div
  class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-6"
>
  âœ… ãƒ‡ãƒ¼ã‚¿åˆ†æãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸï¼
</div>

<!-- çµ±è¨ˆã‚«ãƒ¼ãƒ‰ã‚°ãƒªãƒƒãƒ‰ -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8">
  <div class="bg-white border rounded shadow-sm p-6 text-center">
    <div class="text-3xl font-bold text-blue-600 mb-2">
      {{ stats.total_predictions }}
    </div>
    <div class="text-sm text-gray-500">ğŸ¯ TimeLineä¸Šã®å…¨äºˆæƒ³æ•°</div>
  </div>

  <div class="bg-white border rounded shadow-sm p-6 text-center">
    <div class="text-3xl font-bold text-green-600 mb-2">
      {{ stats.total_races }}
    </div>
    <div class="text-sm text-gray-500">ğŸ‡ äºˆæƒ³å¯èƒ½ãƒ¬ãƒ¼ã‚¹æ•°</div>
  </div>

  <div class="bg-white border rounded shadow-sm p-6 text-center">
    <div class="text-3xl font-bold text-purple-600 mb-2">
      {{ stats.total_horses }}
    </div>
    <div class="text-sm text-gray-500">ğŸ å‡ºé¦¬æ•°</div>
  </div>

  <div class="bg-white border rounded shadow-sm p-6 text-center">
    <div class="text-3xl font-bold text-orange-600 mb-2">
      {{ stats.total_results }}
    </div>
    <div class="text-sm text-gray-500">ğŸ çµæœç™ºè¡¨æ¸ˆã¿ãƒ¬ãƒ¼ã‚¹æ•°</div>
  </div>

  <div class="bg-white border rounded shadow-sm p-6 text-center">
    <div class="text-3xl font-bold text-indigo-600 mb-2">
      {{ stats.total_users }}
    </div>
    <div class="text-sm text-gray-500">ğŸ‘¥ ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°</div>
  </div>

  <div class="bg-white border rounded shadow-sm p-6 text-center">
    <div class="text-3xl font-bold text-red-600 mb-2">
      {{ stats.accuracy_rate }}%
    </div>
    <div class="text-sm text-gray-500">ğŸ“Š çš„ä¸­ç‡</div>
  </div>
</div>

<!-- åˆ†æã‚°ãƒ©ãƒ• -->
<div class="bg-white border rounded shadow-sm p-6">
  <h2 class="text-xl font-bold text-blue-700 mb-4">ğŸ“ˆ è©³ç´°åˆ†æã‚°ãƒ©ãƒ•</h2>
  <div class="text-center">
    <img
      src="data:image/png;base64,{{ chart }}"
      alt="åˆ†æã‚°ãƒ©ãƒ•"
      class="max-w-full h-auto mx-auto rounded border shadow-sm"
    />
  </div>
</div>

<!-- è©³ç´°ãƒ‡ãƒ¼ã‚¿ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
<div class="mt-8 grid grid-cols-1 lg:grid-cols-2 gap-6">
  <!-- çš„ä¸­ç‡è©³ç´° -->
  <div class="bg-white border rounded shadow-sm p-6">
    <h3 class="text-lg font-bold text-blue-700 mb-3">ğŸ¯ çš„ä¸­ç‡è©³ç´°</h3>
    <div class="space-y-2">
      <div class="flex justify-between">
        <span class="text-gray-600">è©•ä¾¡æ¸ˆã¿äºˆæƒ³æ•°:</span>
        <span class="font-bold">{{ stats.evaluated_predictions }}</span>
      </div>
      <div class="flex justify-between">
        <span class="text-gray-600">çš„ä¸­ç‡:</span>
        <span class="font-bold text-green-600">{{ stats.accuracy_rate }}%</span>
      </div>
      <div class="w-full bg-gray-200 rounded-full h-2">
        <div
          class="bg-green-500 h-2 rounded-full"
          style="width: {{ stats.accuracy_rate }}%"
        ></div>
      </div>
    </div>
  </div>

  <!-- ãƒ‡ãƒ¼ã‚¿æ¦‚è¦ -->
  <div class="bg-white border rounded shadow-sm p-6">
    <h3 class="text-lg font-bold text-blue-700 mb-3">ğŸ“‹ ãƒ‡ãƒ¼ã‚¿æ¦‚è¦</h3>
    <ul class="space-y-2 text-sm">
      <li class="flex items-center space-x-2">
        <span class="w-2 h-2 bg-blue-500 rounded-full"></span>
        <span class="text-gray-600">äºˆæƒ³: {{ stats.total_predictions }}ä»¶</span>
      </li>
      <li class="flex items-center space-x-2">
        <span class="w-2 h-2 bg-green-500 rounded-full"></span>
        <span class="text-gray-600">ãƒ¬ãƒ¼ã‚¹: {{ stats.total_races }}ä»¶</span>
      </li>
      <li class="flex items-center space-x-2">
        <span class="w-2 h-2 bg-purple-500 rounded-full"></span>
        <span class="text-gray-600">é¦¬: {{ stats.total_horses }}é ­</span>
      </li>
      <li class="flex items-center space-x-2">
        <span class="w-2 h-2 bg-orange-500 rounded-full"></span>
        <span class="text-gray-600">çµæœ: {{ stats.total_results }}ä»¶</span>
      </li>
      <li class="flex items-center space-x-2">
        <span class="w-2 h-2 bg-indigo-500 rounded-full"></span>
        <span class="text-gray-600">ãƒ¦ãƒ¼ã‚¶ãƒ¼: {{ stats.total_users }}äºº</span>
      </li>
      <li class="flex items-center space-x-2">
        <span class="w-2 h-2 bg-pink-500 rounded-full"></span>
        <span class="text-gray-600">ã‚°ãƒ«ãƒ¼ãƒ—: {{ stats.total_groups }}çµ„</span>
      </li>
    </ul>
  </div>
</div>

{% else %}
<!-- ã‚¨ãƒ©ãƒ¼è¡¨ç¤º -->
<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
  <h2 class="text-lg font-bold mb-2">âš ï¸ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</h2>
  <p class="mb-2"><strong>è©³ç´°:</strong> {{ error }}</p>
  <p class="text-sm">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ¥ç¶šã‚„ãƒ‡ãƒ¼ã‚¿ã®ç¢ºèªã‚’ãŠè©¦ã—ãã ã•ã„ã€‚</p>
</div>
{% endif %}

<!-- æˆ»ã‚‹ãƒªãƒ³ã‚¯ -->
<a href="/timeline/" class="text-sm text-gray-500 mt-6 block"
  >â† ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã¸</a
>

{% endblock %}
